<?xml version="1.0" encoding="utf-8"?>
<search>
  
    
    <entry>
      <title><![CDATA[adb实用命令小结]]></title>
      <url>%2F2017%2F04%2F18%2Fadb%E5%AE%9E%E7%94%A8%E5%91%BD%E4%BB%A4%E5%B0%8F%E7%BB%93%2F</url>
      <content type="text"><![CDATA[adb对于Android程序员来说在日常的工作中使用频率很高，现将自己工作中常用的adb命令总结一下备忘，方便查询，也供大家参考。查看应用内存占用，耗电信息，启动时间，wakelock，跑monkey的命令在之前的应用性能优化中起了不小的作用。以下adb命令的测试机器为小米3,其中package_name代表包名。 基础脚本:1、启动adb服务 1adb start-server 2、终止adb服务 1adb kill-server 3、进入adb运行环境 1adb shell 4、获取帮助 里面有adb的各种命令和参数的介绍 1adb help 5、查看adb版本 1adb version 6、以root权限重启adb 1adb root 7、将system分区重新挂在为可读写分区，此命令在操作系统目录时很重要 1adb remount 8、重启设备,可选参数进入bootloader(刷机模式)或recovery(恢复模式) 1adb reboot [bootloader|recovery] apk相关:1、安装apk 1234adb install test.apk -r 覆盖安装，保留数据和缓存文件 -d 解决低版本version问题 -s 安装apk到sd卡 2、卸载apk 1adb uninstall -k &lt;package_name&gt; 可选参数-k的作用为卸载软件但是保留配置和缓存文件 3、查看app相关所有信息，包括action,codepath,version,需要的权限等等信息 1adb shell dumpsys package &lt;package_name&gt; 4、查看app的路径 1adb shell pm path &lt;package_name&gt; 查看了一个普通app的路径，如下，位于data/app下面的普通apppackage:/data/app/com.tencent.test-1/base.apk 5、查看apk的版本信息 1adb shell dumpsys package &lt;package_name&gt; | grep version 如果你得到的是下图的两个version版本，则为系统app,下面是系统app本身的版本，上面是升级之后的系统app的版本信息 1234versionCode=8 targetSdk=22 versionName=V0.08versionCode=6 targetSdk=22 versionName=V0.0 6、启动activity 1adb shell am start -n &lt;package_name&gt;/.&lt;activity_class_name&gt; 7、获得应用的启动时间，可以很方便地获取应用的启动时间 1adb shell am start -W &lt;package_name&gt;/.&lt;activity_class_name&gt; 试验结果如下: 12345678adb shell am start -W com.cc.test/com.painter.test.PainterMainActivityStarting: Intent &#123; act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] cmp=com.cc.test/com.painter.test.PainterMainActivity &#125;Status: okActivity: com.cc.test/com.painter.test.PainterMainActivityThisTime: 355TotalTime: 355WaitTime: 365Complete 返回的几个结果，以WaitTime为准，返回的是从startActivity到应用第一帧完全显示的时间。 8、启动service,am的-n参数表示组件，-a参数表示命令，-a后面的参数为manifest中定义的service的action 1adb shell am startservice -n &lt;package_name&gt;/.&lt;service_class_name&gt; 也可: 1adb shell am startservice -a &quot;android.intent.action.CALL&quot; 9、发送广播 1adb shell am broadcast -a &quot;android.intent.action.AdupsFota.WriteCommandReceiver&quot; 广播可以带上不同类型的参数,–es为string参数类型,–ei为int参数类型,–ez为boolean参数类型 1adb shell am broadcast -a &quot;android.intent.action.AdupsFota.WriteCommandReceiver&quot; --es test_string &quot;this is test string&quot; 10、查看某个app的进程相关信息10.1 1adb shell ps &lt;package_name|PID&gt; 例如 1234adb shell ps com.ma.app:pushUSER PID PPID VSIZE RSS WCHAN PC NAMEu0_a116 5483 304 1776564 55112 sys_epoll_ 00000000 S com.ma.app:push 小米手机上测试成功，在另外一个设备上，如果ps后面的参数是包名则显示不了进程的详细信息，参见下面的方式获取 10.2 1adb shell ps | grep &lt;package_name&gt; 11、杀掉某个进程，一般用于模拟某个bug复现 1adb shell kill pidNumber 12、查看某一个app的内存占用 1adb shell dumpsys meminfo &lt;package_name|PID&gt; 结果如下，其中的Heap size包括了Dalvik Heap和Native Heap,平时我们所说的内存限制指的是Dalvik Heap。 1234567891011121314151617 Pss Private Private Swapped Heap Heap Heap Total Dirty Clean Dirty Size Alloc Free ------ ------ ------ ------ ------ ------ ------ Native Heap 18956 18940 0 4696 44288 21352 22935 Dalvik Heap 60102 60088 0 26192 104486 88285 16201 App Summary Pss(KB) ------ Java Heap: 61640 Native Heap: 18940 Code: 3356 Stack: 428 Graphics: 16876 Private Other: 3840 System: 2031... 13、查看单个应用程序的最大内存限制 1adb shell getprop | grep heapgrowthlimit 得到的结果为128M: [dalvik.vm.heapgrowthlimit]: [128m] 这就是说Dalvik Heap size的最大值超过了128M，就很可能发生OOM 14、获取单个应用的电量消耗信息Battery Historian是Android 5.0开始引入的，下面的命令为获取单个app的电量消耗信息，获取系统耗电信息见下节 1adb shell dumpsys batterystats &gt; &lt;package_name&gt; &gt; xxx.txt 上面的电量信息为原始数据，可以通过google编写的historian.py脚本把数据信息转换为可读性很好的html文件,类似TraceView生成的列表数据，之前在做app性能优化的时候起了很大的作用 1python historian.py xxx.txt &gt; xxx.html 15、跑monkey,个人很喜欢这个命令，运行过程中，应用程序会不断切换画面，按照选定的不同级别反馈信息，还可以看到执行过程报告和生成的事件。测试应用的稳定性时很实用。 现在studio也有了monkeyrunner的tool 123adb shell monkey -v -p &lt;package_name&gt; 500 -p 对象包 -v 反馈信息级别 12345:Monkey: seed=1493061025112 count=500:AllowPackage: com.tencent.mm.app:push:IncludeCategory: android.intent.category.LAUNCHER:IncludeCategory: android.intent.category.MONKEY** No activities found to run, monkey aborted. 系统相关1、查看设备名称，豌豆荚等应用就是通过此来获得设备的名称 1adb shell cat /system/build.prop/ 结果: 12ro.product.model=MI 3Wro.product.brand=Xiaomi 2、查看手机分辨率有两种方法，第二种方法最为简洁2.1 1adb shell dumpsys window | grep Surface grep是一个非常有用的参数,具体含义和用法大家自行google一下,试验结果为1080 * 1920: 1Surface: shown=false layer=21000 alpha=1.0 rect=(0.0,0.0) 1080.0 x 1920.0 2.2. 1adb shell wm size 返回结果为: 1Physical size: 1080x1920 3、查看手机sdk版本 1adb shell getprop | grep version 运行上面的命令后，列出来的version中[ro.build.version.release]: [6.0.1]即为手机sdk版本 4、查看手机型号信息 1adb shell getprop | grep product 运行此命令之后，能看到product,board,brand和cpu等等的型号 5、获取序列号，获取到的序列号即为adb devices列出来的序列号 1adb get-serialno 6、查看连接的设备 1adb devices 如果有多个设备连接，想对其中的某一设备进行操作，就需要在此命令的后面加参数 1234567adb [-d|-e|-s &lt;serial Number&gt;] &lt;command&gt; -d:真机(多个设备中只有一个真机时适用) -e:模拟器(多个设备中只有一个模拟器时适用) -s:序列号 假如有两个真机连接了我的电脑，adb devices获取到的数据如下 123List of devices attached1b71651 device12sdfsd device 进入1b71651设备的命令为: 1adb -s 1b71651 shell 7、查看wifi密码(需要root权限) 1adb shell cat data/misc/wifi/*.conf 8、查看wifi_mac 1adb shell cat /sys/class/net/wlan0/address 运行此命令，93:a1:a2:91:d1:c1是小米3的wifi_mac地址 9、查看后台services信息 1adb shell service list 运行结果为 1234Found 126 services:0 miui.whetstone.net: [miui.whetstone.INetworkService]1 miui.whetstone.power: [miui.whetstone.power]... 10、查看系统当前内存占用，为综述 1adb shell cat /proc/meminfo 运行结果: 12345678MemTotal: 1893504 kBMemFree: 81200 kBBuffers: 14828 kBCached: 244152 kBSwapCached: 15152 kBActive: 541680 kBInactive: 575280 kB... 11、查看各进程详细内存占用和系统的内存占用有几种方法 11.1 1adb shell dumpsys meminfo 12345Total PSS SWAP by process: 97858 kB: 34944 kB: com.android.systemui (pid 2769) ...Total RAM: 1893504 kB (status normal)Free RAM: 344212 kB (117992 cached pss + 136016 cached kernel + 90204 free) Total PSS 信息就是你的应用真正占据的内存大小，通过这个信息，可以轻松判别手机中哪些程序占内存比较大。 11.2 查看各进程内存的另一方法 不是所有设备都支持 1adb shell procrank 运行结果如下: 12345678PID Vss Rss Pss Uss cmdline 496 1810184K 92744K 57607K 48348K system_server 743 1847492K 84492K 52117K 46796K com.android.systemui .... ------ ------ ------ 328259K 261484K TOTALRAM: 2061012K total, 889152K free, 40940K buffers, 612032K cached, 300K shmem, 62556K slab 其中 1234VSS – Virtual Set Size 虚拟耗用内存（包含共享库占用的内存）RSS – Resident Set Size 实际使用物理内存（包含共享库占用的内存）PSS – Proportional Set Size 实际使用的物理内存（比例分配共享库占用的内存）USS – Unique Set Size 进程独自占用的物理内存（不包含共享库占用的内存） 11.3 查看设备上进程的cpu和内存占用情况 1adb shell top 12、查看系统耗电情况 1adb shell dumpsys batterystats &gt; xxx.txt 13、查看系统设置的闹钟 1adb shell dumpsys alarm 14、查看系统的wakelock,不合理的使用wakelock会导致系统耗电加剧 1adb shell dumpsys power 返回结果: 123Wake Locks: size=2 PARTIAL_WAKE_LOCK &apos;AudioMix&apos; (uid=1013, pid=236, ws=WorkSource&#123;10018&#125;) PARTIAL_WAKE_LOCK &apos;Android.media.MediaPlayer&apos; ON_AFTER_RELEASE (uid=10018, pid=24023, ws=null) 文件操作相关:1、拷贝文件/目录到设备 1adb push &lt;local&gt;...&lt;remote&gt; 2、从设备拷贝文件/目录，-a参数保留了文件的时间戳和模式 1adb pull [-a] &lt;remote&gt;...&lt;local&gt; 3、查看设备log,和studio和eclipse的logcat相同，可通过参数控制输出的日志 12345adb logcat -s 过滤指定参数log -v time 保留日志时间 &gt;&gt; 追加写 &gt; 覆盖写 下面的命令含义为:打印出log信息中的时间并且包含关键字 “Test” 的所有log以覆盖写的方式保存到test文件 1adb logcat -v time -s Test &gt; test.txt 4、列出目录下的文件和文件夹，可选参数-al可查看文件和文件夹的详细信息 1adb shell ls [-al] 5、进入文件夹 1adb shell cd &lt;folder&gt; 6、查看文件 1adb shell cat &lt;filename&gt; 7、重命名文件 1adb shell rename path/oldfilename path/newfilename 8、删除文件/文件夹 12adb shell rm path/filename -r 可选参数用于删除文件夹及下面的所有文件 eg:adb shell rm -r &lt;folder&gt; 9、移动文件 1adb shell mv path/filename newpath/filename 10、拷贝文件 1adb shell cp file newpath/file1 11、创建目录 1adb shell mkdir path/folder 12、设置文件最高读写权限 1adb shell chmod 777 filename 13、手机未root 查看data/data/某一app文件信息 笔者的小米3没有root，但是又想方便地查看data/data/目录下的一些文件，直接进入data会提示没有权限,查看的方式为进入data/data/后,运行下面的命令，就能直接进入你应用的包下了,可通用cp或者mv拷贝或移动到sdcard目录进行其他操作 1run-as package_name 数据库相关数据库的操作和今天的主题关系不大，增删改查操作不再列举。但是平时的开发过程中只是查看数据库中某个表或者某个字段，也无需每次都pull出来之后再查看，用命令行会更加方便快捷,进入到test.db的目录后，运行如下命令1、操作db 1sqlite3 test.db 2、对db使用sqlite3命令后，通过.help查看各种使用指导 1.help 3、列举数据库的table名称 1.tables 4、列表数据库的schema，个人觉得下面两个命令很有用，效果等同，可以方便快捷地查看数据库字段对应的数据类型，.schema更加简洁 1.schema 或者 1select * from sqlite_master where type = &quot;table&quot;; ps:原创文章，转载注明出处]]></content>
    </entry>

    
    <entry>
      <title><![CDATA[硬装-水路改造前你需要知道的事]]></title>
      <url>%2F2017%2F03%2F26%2F%E7%A1%AC%E8%A3%85-%E6%B0%B4%E8%B7%AF%E6%94%B9%E9%80%A0%E5%89%8D%E4%BD%A0%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84%E4%BA%8B%2F</url>
      <content type="text"><![CDATA[硬装的水路改造有很大的学问，需要提前做好功课。 硬装前无论是新房还是二手房，尤其是二手房翻新，装修前都需要先做闭水测试，装修后出现漏水很麻烦，叫上物业一起进行，确保装修前无问题，有问题马上让物业负责解决;根据各地的水质情况，看是否需要安装入户过滤器，和物业确认入户过滤器是否可放置在楼道，如果不可以，可放在家庭用水总入口处 日常家庭用水很多需要冷热同用，比如热水器、洗碗池、洗手池等。水管的冷热要分离，为了便于日后检查和维修区分，可通过对冷热水管路进行分色套管处理，所有的热水管均为红色，冷水均为蓝色。如果难以分色，也可以按照方向区分，如左边热水，右边冷水 水管的材料，一些老式住宅中还是镀锌管，长期使用后容易产生锈蚀，造成水中重金属含量过高，严重危害人体健康；含铅的PVC管也同样因危害健康被禁止。并非所有的水管都是冷热两用的，一般的PPR管、PE管、铜管都是冷热两用的。PVC管不能用于热水，因此常用于下水道。 水路改造时，管线和接头必须是垂直相接的,否则会造成弯头连接的两遍管线壁厚不一样，使用中可能会因为受力不均匀，在水压下出现渗漏。尤其是靠近电路的水管，防漏和密封性必须保证，否则万一漏水，会引发触电，十分危险。 水路改造常用尺寸 淋浴：冷热水管中心间距150mm，距地1000-1200mm 上翻盖洗衣机：水口高度1200mm 电热水器：给水口高度=层净高-电热水器固定上方距顶距离-电热水器直径-200mm 水盆、菜盆：给水口高度450-550mm 马桶：给水口距地200mm，距马桶中心一般靠左250mm 墩布池：给水口高出池本身200mm为宜 水路改造-验收 打压测试，并非越高越好 水路改造完成后，为了避免漏水，必须进行打压测试。许多业主认为打压越高越好，这样可以测出水管和水路的承受能力,其实并不是打压越高越好，打压压力太高可能会超出水管的承压极限，反而会损伤管道，减少寿命，导致以后出现漏水。正常压力测试在6-8kg为最佳，实验压力不应该小于0.6mpa，时间为20-30分钟。 多次打压测试，效果才好。水路测试并非只有一次，正确的试水方法是：试压前关闭水电阀门，进行室内管路系统打压；将试压管道末端封堵慢慢注水，将管道内气体排出，充满水后进行密封检查；加压采用手动泵或者电动泵缓慢升压，升至规定试验压力后，停止加压，观察接头部位是否有渗水现象；稳压后，半小时内的压力降不超过0.05MPa为合格。 绘制水路图，维修有保障。做到水路改造的房子最好能重新绘制水路图，因为施工时，很多时间由于各种原因无法按照设计图100%实施，所以必须按照实际水路重新制图，以免给日后维修增加难度。 参考: 妈妈网]]></content>
    </entry>

    
    <entry>
      <title><![CDATA[硬装-插座篇]]></title>
      <url>%2F2017%2F03%2F26%2F%E7%A1%AC%E8%A3%85-%E6%8F%92%E5%BA%A7%E4%B8%93%E9%A1%B9%E7%AF%87%2F</url>
      <content type="text"><![CDATA[插座的预留原则是：宁多勿少，免得添加电器时遇到插座不够用的尴尬。 插座规划需要注意的问题以下几点： 插座不够用，满地都是排插线 开关被家具挡住，或者太高太低 没留双控开关 -根据我家户型的实际情况设计了开关和插座的数量,仅作为各位的参考，实际情况还要根据实际户型情况来做调整。 玄关 插座:预留一个 开关:与客厅开关处做双控 客厅 插座: 电视两个(包括电视机和机顶盒) 空调一个 沙发两侧各一个(因户型而异，我家的户型要一侧留2个) 预留1-2个 开关: 吊灯双回路控制 玄关灯双控 装饰效果灯开关 餐厅 插座： 餐桌边2个 预留1-2个 开关： 吊灯双回路控制 装饰效果灯 厨房 插座: 抽油烟机1个(3孔带开关) 炉灶下1个 水槽下1个(广州水质比较差，除了在总入水口安装入户过滤器之外，需要在水槽下安装净水器) 水台边1个 操作台2-3个 电冰箱(3孔带开关) 微波炉、烤箱、洗碗机、洗菜机等电器按需添加插座和开关 开关: 吸顶灯 操作台灯 洗手间 插座: 吹风机1个(3孔带开关或普通插座无开关) 电热水器1个(3孔带开关) 浴霸 预留1-2个 开关: 镜前灯 排风扇 浴霸 吸顶灯 卧室 插座: 床头两边各1个;预留1-2个 电视2个 空调1个 电脑1个(带网线[根据实际需求]) 开关: 双控或双回路控制(需控制家里所有的灯) 位于床头，方便控制 吸顶灯 装饰效果灯根据我家的实际情况，次卧需要为孩子的电脑、台灯预留插座。 书房 插座: 电脑1个(3孔带开关) 空调1个(3孔带开关) 书桌1个 预留1-2个 开关: 吸顶灯 电脑电视共享 阳台 插座: 洗衣机 开关: 顶灯 插座的推荐安装位置 市面上不错的插座位置 参考: 妈妈网]]></content>
    </entry>

    
    <entry>
      <title><![CDATA[Hello World]]></title>
      <url>%2F2017%2F03%2F19%2Fhello-world%2F</url>
      <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
    </entry>

    
  
  
</search>
